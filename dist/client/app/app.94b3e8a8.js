"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}angular.module("dokkuUiApp",["dokkuUiApp.constants","ngCookies","ngResource","ngSanitize","btford.socket-io","ui.router","angularModalService","ui.select"]).config(["$urlRouterProvider","$locationProvider",function(a,b){a.otherwise("/"),b.html5Mode(!0)}]),angular.module("dokkuUiApp.util",[]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ModalDeleteConfigController=function(){function a(b,c,d){_classCallCheck(this,a),this.exit=b,this.inputs={key:c,value:d}}return a.$inject=["close","key","value"],_createClass(a,[{key:"close",value:function(){this.exit({key:this.inputs.key,value:this.inputs.value},500)}}]),a}();angular.module("dokkuUiApp").controller("ModalDeleteConfigController",ModalDeleteConfigController);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ActivitiesController=function(){function a(b,c,d){_classCallCheck(this,a),this.$stateParams=b,this.$http=c,this.$location=d,this.fetch()}return a.$inject=["$stateParams","$http","$location"],_createClass(a,[{key:"fetch",value:function(){var a=this;this.$stateParams.app?this.$http.get("/api/apps/"+this.$stateParams.app+"/activities").then(function(b){a.activities=b.data}):this.$location.path("/apps")}}]),a}();angular.module("dokkuUiApp").controller("ActivitiesController",ActivitiesController),angular.module("dokkuUiApp").config(["$stateProvider",function(a){a.state("app-overview",{url:"/apps/:app",templateUrl:"app/apps/overview/overview.html",controller:"OverviewController",controllerAs:"vm"}).state("app-activities",{url:"/apps/:app/activities",templateUrl:"app/apps/activities/activities.html",controller:"ActivitiesController",controllerAs:"vm"}).state("app-access",{url:"/apps/:app/access",templateUrl:"app/apps/access/access.html",controller:"AccessController",controllerAs:"vm"}).state("app-settings",{url:"/apps/:app/settings",templateUrl:"app/apps/settings/settings.html",controller:"SettingsController",controllerAs:"vm"})}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),OverviewController=function(){function a(b,c,d,e,f){_classCallCheck(this,a),this.$rootScope=b,this.$stateParams=c,this.$http=d,this.$location=e,this.ModalService=f,this.fetch()}return a.$inject=["$rootScope","$stateParams","$http","$location","ModalService"],_createClass(a,[{key:"fetch",value:function(){var a=this;this.$stateParams.app?this.$http.get("/api/apps/"+this.$stateParams.app).then(function(b){a.$rootScope.app=b.data}):this.$location.path("/apps")}},{key:"editConfig",value:function(a,b){this.ModalService.showModal({templateUrl:"app/modals/edit-config/edit-config.html",controller:"ModalEditConfigController",controllerAs:"vm",inputs:{key:a,value:b}}).then(function(a){a.element.modal(),a.close.then(function(a){console.log(a)})})}},{key:"deleteConfig",value:function(a,b){this.ModalService.showModal({templateUrl:"app/modals/delete-config/delete-config.html",controller:"ModalDeleteConfigController",controllerAs:"vm",inputs:{key:a,value:b}}).then(function(a){a.element.modal(),a.close.then(function(a){console.log(a)})})}}]),a}();angular.module("dokkuUiApp").controller("OverviewController",OverviewController);var SettingsController=function a(){_classCallCheck(this,a)};angular.module("dokkuUiApp").controller("SettingsController",SettingsController);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(){var a=function(){function a(b,c,d){_classCallCheck(this,a),this.$http=b,this.socket=d,this.awesomeThings=[],c.$on("$destroy",function(){d.unsyncUpdates("thing")})}return a.$inject=["$http","$scope","socket"],_createClass(a,[{key:"$onInit",value:function(){var a=this;this.$http.get("/api/things").then(function(b){a.awesomeThings=b.data,a.socket.syncUpdates("thing",a.awesomeThings)})}},{key:"addThing",value:function(){this.newThing&&(this.$http.post("/api/things",{name:this.newThing}),this.newThing="")}},{key:"deleteThing",value:function(a){this.$http["delete"]("/api/things/"+a._id)}}]),a}();angular.module("dokkuUiApp").component("main",{templateUrl:"app/main/main.html",controller:a})}(),angular.module("dokkuUiApp").config(["$stateProvider",function(a){a.state("main",{url:"/",template:"<main></main>"})}]);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),AccessController=function(){function a(b,c,d,e,f){_classCallCheck(this,a),this.$rootScope=b,this.$stateParams=c,this.$http=d,this.$location=e,this.ModalService=f,this.fetch()}return a.$inject=["$rootScope","$stateParams","$http","$location","ModalService"],_createClass(a,[{key:"fetch",value:function(){var a=this;this.$stateParams.app?this.$http.get("/api/apps/"+this.$stateParams.app).then(function(b){a.$rootScope.app=b.data}):this.$location.path("/apps")}},{key:"addCollaborator",value:function(a){var b=this;this.ModalService.showModal({templateUrl:"app/modals/edit-collaborators/edit-collaborators.html",controller:"ModalEditCollaboratorsController",controllerAs:"vm",inputs:{collaborators:a.collaborators}}).then(function(c){c.element.modal(),c.close.then(function(c){a.collaborators=c.collaborators.map(function(a){return a._id}),b.$http.put("/api/apps/"+a.name,a).then(function(a){b.fetch()})})})}}]),a}();angular.module("dokkuUiApp").controller("AccessController",AccessController);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ModalEditCollaboratorsController=function(){function a(b,c,d){_classCallCheck(this,a),this.exit=b,this.$http=c,this.inputs={collaborators:d},this.fetch()}return a.$inject=["close","$http","collaborators"],_createClass(a,[{key:"fetch",value:function(){var a=this;this.$http.get("/api/users").then(function(b){a.inputs.users=b.data})}},{key:"close",value:function(){this.exit({collaborators:this.inputs.collaborators},500)}}]),a}();angular.module("dokkuUiApp").controller("ModalEditCollaboratorsController",ModalEditCollaboratorsController);var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),ModalEditConfigController=function(){function a(b,c,d){_classCallCheck(this,a),this.exit=b,this.inputs={key:c,value:d}}return a.$inject=["close","key","value"],_createClass(a,[{key:"close",value:function(){this.exit({key:this.inputs.key,value:this.inputs.value},500)}}]),a}();angular.module("dokkuUiApp").controller("ModalEditConfigController",ModalEditConfigController),angular.module("dokkuUiApp").directive("footer",function(){return{templateUrl:"components/footer/footer.html",restrict:"E",link:function(a,b){b.addClass("footer")}}});var NavbarController=function b(a,c){_classCallCheck(this,b),a.get("/api/apps").then(function(a){c.apps=a.data})};NavbarController.$inject=["$http","$scope"],angular.module("dokkuUiApp").controller("NavbarController",NavbarController),angular.module("dokkuUiApp").directive("navbar",function(){return{templateUrl:"components/navbar/navbar.html",restrict:"E",controller:"NavbarController",controllerAs:"nav"}}),angular.module("dokkuUiApp").factory("socket",["socketFactory",function(a){var b=io("",{path:"/socket.io-client"}),c=a({ioSocket:b});return{socket:c,syncUpdates:function(a,b,d){d=d||angular.noop,c.on(a+":save",function(a){var c=_.find(b,{_id:a._id}),e=b.indexOf(c),f="created";c?(b.splice(e,1,a),f="updated"):b.push(a),d(f,a,b)}),c.on(a+":remove",function(a){var c="deleted";_.remove(b,{_id:a._id}),d(c,a,b)})},unsyncUpdates:function(a){c.removeAllListeners(a+":save"),c.removeAllListeners(a+":remove")}}}]),function(a,b){a.module("dokkuUiApp.constants",[]).constant("appConfig",{userRoles:["guest","user","admin"]})}(angular),function(){function a(a){var b={safeCb:function(a){return angular.isFunction(a)?a:angular.noop},urlParse:function(a){var b=document.createElement("a");return b.href=a,""===b.host&&(b.href=b.href),b},isSameOrigin:function(c,d){return c=b.urlParse(c),d=d&&[].concat(d)||[],d=d.map(b.urlParse),d.push(a.location),d=d.filter(function(a){return c.hostname===a.hostname&&c.port===a.port&&c.protocol===a.protocol}),d.length>=1}};return b}a.$inject=["$window"],angular.module("dokkuUiApp.util").factory("Util",a)}(),angular.module("dokkuUiApp").run(["$templateCache",function(a){a.put("app/apps/access/access.html",'<section><div class="nav nav-tabs dokku-submenu"><h4 class=text-primary>{{app.name}}</h4><a class=sub-nav-item href=/apps/{{app.name}}><i class="glyphicon glyphicon-dashboard"></i> &nbsp; Overview</a> <a class=sub-nav-item href=/apps/{{app.name}}/activities><i class="glyphicon glyphicon-cloud-upload"></i> &nbsp; Activities</a> <a class="sub-nav-item active" href=/apps/{{app.name}}/access><i class="glyphicon glyphicon-user"></i> &nbsp; Access</a> <a class=sub-nav-item href=/apps/{{app.name}}/settings><i class="glyphicon glyphicon-cog"></i> &nbsp; Setting</a></div><div class=row><div class=col-md-4><h3>Access</h3></div><div class=col-md-8><dl class="dl-horizontal dokku-info"><dt><i class="glyphicon glyphicon-plus"></i></dt><dd><b><a href="javascript: void(0);" ng-click=vm.addCollaborator(app)>Add Collaborator</a></b></dd><div ng-repeat="user in app.collaborators"><dt>{{user.firstName}} {{user.lastName}}</dt><dd>{{user.username}} &lt;{{user.email}}&gt;</dd></div></dl></div></div></section>'),a.put("app/apps/activities/activities.html",'<section><div class="nav nav-tabs dokku-submenu"><h4 class=text-primary>{{app.name}}</h4><a class=sub-nav-item href=/apps/{{app.name}}><i class="glyphicon glyphicon-dashboard"></i> &nbsp; Overview</a> <a class="sub-nav-item active" href=/apps/{{app.name}}/activities><i class="glyphicon glyphicon-cloud-upload"></i> &nbsp; Activities</a> <a class=sub-nav-item href=/apps/{{app.name}}/access><i class="glyphicon glyphicon-user"></i> &nbsp; Access</a> <a class=sub-nav-item href=/apps/{{app.name}}/settings><i class="glyphicon glyphicon-cog"></i> &nbsp; Setting</a></div><div class=row><div class=col-md-4><h3>Access</h3></div><div class=col-md-8><ul><li ng-repeat="activity in vm.activities">{{activity.command}} {{activity.app.name}} {{activity.params}} - {{activity.user.username}} - {{activity.updated_at}}</li></ul></div></div></section>'),a.put("app/apps/overview/overview.html",'<section><div class="nav nav-tabs dokku-submenu"><h4 class=text-primary>{{app.name}}</h4><a class="sub-nav-item active" href=/apps/{{app.name}}><i class="glyphicon glyphicon-dashboard"></i> &nbsp; Overview</a> <a class=sub-nav-item href=/apps/{{app.name}}/activities><i class="glyphicon glyphicon-cloud-upload"></i> &nbsp; Activities</a> <a class=sub-nav-item href=/apps/{{app.name}}/access><i class="glyphicon glyphicon-user"></i> &nbsp; Access</a> <a class=sub-nav-item href=/apps/{{app.name}}/settings><i class="glyphicon glyphicon-cog"></i> &nbsp; Setting</a></div><div class=row><div class=col-md-4><h3>Info</h3></div><div class=col-md-8><dl class="dl-horizontal dokku-info"><dt>Web URL</dt><dd>{{app.web_url}}</dd><dt>Git URL</dt><dd>{{app.git_url}}</dd><dt>Created at</dt><dd>{{app.created_at}}</dd><dt>Updated at</dt><dd>{{app.updated_at}}</dd></dl></div></div><hr><div class=row><div class=col-md-4><h3>Config Variables</h3><p>Lorem ipsum</p></div><div class=col-md-8><ul class="list-unstyled dokku-list-fields"><li ng-repeat="config in app.configs"><div ng-repeat="(key, value) in config" class=form-group><div class=row><div class=col-sm-5><input class=form-control readonly ng-model=key></div><div class=col-sm-5><input class=form-control readonly ng-model=value></div><div class=col-sm-2><div class=btn-group><button class="btn btn-default" ng-click="vm.editConfig(key, value)"><i class="glyphicon glyphicon-pencil"></i></button> <button class="btn btn-danger" ng-click="vm.deleteConfig(key, value)"><i class="glyphicon glyphicon-remove"></i></button></div></div></div></div></li></ul></div></div><hr><div class=row><div class=col-md-4><h3>Domains</h3></div><div class=col-md-8><h5>Dokku domain</h5><input class=form-control ng-model=app.domains[0].hostname><br><h5>Custom Domains</h5><div ng-show="app.domains.length == 1" class="panel panel-default"><div class="panel-body text-center"><h4>Custom domains will appear here</h4><small>Custom domains allow you to access your app via one or more non-Heroku domain names (for example, <code>www.yourcustomdomain.com)</code></small></div></div><ul class="list-unstyled dokku-list-fields"><li ng-repeat="domain in app.domains" ng-show="$index > 0"><div class=form-group><div class=row><div class=col-sm-5><input class=form-control readonly ng-model=domain.hostname></div><div class=col-sm-5><input class=form-control readonly ng-model=domain.cname></div><div class=col-sm-2><div class=btn-group><button class="btn btn-default" disabled><i class="glyphicon glyphicon-pencil"></i></button> <button class="btn btn-danger"><i class="glyphicon glyphicon-remove"></i></button></div></div></div></div></li></ul></div></div></section>'),a.put("app/apps/settings/settings.html",'<section><div class="nav nav-tabs dokku-submenu"><h4 class=text-primary>{{app.name}}</h4><a class=sub-nav-item href=/apps/{{app.name}}><i class="glyphicon glyphicon-dashboard"></i> &nbsp; Overview</a> <a class=sub-nav-item href=/apps/{{app.name}}/activities><i class="glyphicon glyphicon-cloud-upload"></i> &nbsp; Activities</a> <a class=sub-nav-item href=/apps/{{app.name}}/access><i class="glyphicon glyphicon-user"></i> &nbsp; Access</a> <a class="sub-nav-item active" href=/apps/{{app.name}}/settings><i class="glyphicon glyphicon-cog"></i> &nbsp; Setting</a></div></section>'),a.put("app/main/main.html",'<header class=hero-unit id=banner><div class=container><h1>\'Allo, \'Allo!</h1><p class=lead>Kick-start your next web app with Angular Fullstack</p><img src=assets/images/yeoman.462ccecb.png alt="I\'m Yeoman"></div></header><div class=container><div class=row><div class=col-lg-12><h1 class=page-header>Features:</h1><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="thing in $ctrl.awesomeThings"><li><a href=# uib-tooltip={{thing.info}}>{{thing.name}}<button type=button class=close ng-click=$ctrl.deleteThing(thing)>&times;</button></a></li></ul></div></div><form class=thing-form><label>Syncs in realtime across clients</label><p class=input-group><input class=form-control placeholder="Add a new thing here." ng-model=$ctrl.newThing> <span class=input-group-btn><button type=submit class="btn btn-primary" ng-click=$ctrl.addThing()>Add New</button></span></p></form></div>'),a.put("app/modals/create-app/create-app.client.view.html",'<div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close ng-click=close() data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class="modal-title text-center">Create app</h4></div><div class=modal-body>lorem</div><div class=modal-footer><button type=button class="btn btn-block btn-primary" ng-click=close() data-dismiss=modal>Save changes</button></div></div></div></div>'),a.put("app/modals/delete-config/delete-config.html",'<div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close ng-click=vm.close() data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class="modal-title text-center">Delete</h4></div><div class=modal-body><p>Are you sure you want to remove this config variable <code>{{vm.inputs.key}}</code>?</p></div><div class=modal-footer><button type=button class="btn btn-block btn-danger" ng-click=vm.close() data-dismiss=modal>Delete</button></div></div></div></div>'),a.put("app/modals/edit-collaborators/edit-collaborators.html",'<div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close ng-click=vm.close() data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class="modal-title text-center">Edit collaborators</h4></div><div class=modal-body><ui-select multiple sortable ng-model=vm.inputs.collaborators close-on-select=false><ui-select-match>{{$item.firstName}} {{$item.lastName}}</ui-select-match><ui-select-choices repeat="user in vm.inputs.users | filter: $select.search"><div ng-bind-html="user.firstName + \' \' + user.lastName | highlight: $select.search"></div><small><span ng-bind-html="user.username | highlight: $select.search"></span> &lt;<span ng-bind-html="user.email | highlight: $select.search"></span>&gt;</small></ui-select-choices></ui-select></div><div class=modal-footer><button type=button class="btn btn-block btn-primary" ng-click=vm.close() data-dismiss=modal>Save changes</button></div></div></div></div>'),a.put("app/modals/edit-config/edit-config.html",'<div class="modal fade"><div class=modal-dialog><div class=modal-content><div class=modal-header><button type=button class=close ng-click=vm.close() data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class="modal-title text-center">Edit config variable</h4></div><div class=modal-body><div class=form-group><label>Key</label><input class=form-control readonly ng-model=vm.inputs.key></div><div class=form-group><label>Value</label><input class=form-control ng-model=vm.inputs.value></div></div><div class=modal-footer><button type=button class="btn btn-block btn-primary" ng-click=vm.close() data-dismiss=modal>Save changes</button></div></div></div></div>'),a.put("components/footer/footer.html","<div class=container><p>Dokku UI v0.0.1 &nbsp; | &nbsp; <a href=#>@pltchuong</a> &nbsp; | &nbsp; &copy; 2016</p></div>"),a.put("components/navbar/navbar.html",'<div class="navmenu navmenu-default navmenu-fixed-left offcanvas-sm dokku-menu"><a class="navmenu-brand visible-md visible-lg" href=/apps><img class=logo width=30 src=/assets/images/dokku.9d7a6ed9.png> Dokku</a><ul class="nav navmenu-nav"><li><input class=form-control ng-model=search.name></li><li><a href="javascript: void(0)" ng-click=createApp()><i class="glyphicon glyphicon-plus"></i> New application</a></li><li ng-repeat="app in apps | filter:search:strict" ng-class="{active: $root.app.name == app.name}"><a href=/apps/{{app.name}}>{{app.name}}</a></li></ul></div><div class="navbar navbar-default navbar-fixed-top hidden-md hidden-lg"><button type=button class=navbar-toggle data-toggle=offcanvas data-target=.navmenu><span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href=/apps><img class=logo width=30 src=/modules/dokku/client/img/dokku.png> Dokku</a></div>')}]);